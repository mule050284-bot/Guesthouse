<!DOCTYPE html>
<html lang="am">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Churchill Guest House Portal</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .room-card { transition: 0.2s; cursor: pointer; border: 2px solid #ddd; }
        .occupied { background-color: #fee2e2; border-color: #ef4444; color: #b91c1c; }
        .available { background-color: #f0fdf4; border-color: #22c55e; color: #15803d; }
        .required::after { content: " *"; color: red; }
    </style>
</head>
<body class="bg-gray-100 pb-10">

    <div class="max-w-2xl mx-auto p-4">
        <header class="bg-blue-900 text-white p-6 rounded-b-2xl mb-6 shadow-lg text-center font-bold">
            Churchill Guest House á‰áŒ¥áŒ¥áˆ­
        </header>

        <div class="mb-6">
            <h2 class="font-bold text-gray-700 mb-3 text-sm">áŠ­ááˆ á‹­áˆáˆ¨áŒ¡ / Select Room</h2>
            <div id="roomGrid" class="grid grid-cols-4 gap-2 text-center font-bold"></div>
        </div>

        <div class="bg-white p-6 rounded-xl shadow-md border border-gray-200">
            <form id="bookingForm" class="grid grid-cols-1 md:grid-cols-2 gap-4 text-sm">
                <div class="md:col-span-2">
                    <label class="required font-semibold">á‹¨áˆªáˆ´á•áˆ½áŠ• áˆµáˆ (Staff Name)</label>
                    <input type="text" id="receptionName" required class="w-full p-2 border rounded outline-none focus:ring-2 focus:ring-blue-300">
                </div>
                <div><label class="font-semibold text-gray-500">áŠ­ááˆ á‰áŒ¥áˆ­</label>
                    <input type="text" id="roomNum" readonly class="w-full p-2 border rounded bg-gray-50 font-bold text-blue-800">
                </div>
                <div><label class="required font-semibold">á‹¨áŠ¥áŠ•áŒá‹³ áˆµáˆ</label>
                    <input type="text" id="guestName" required class="w-full p-2 border rounded">
                </div>
                <div><label class="required font-semibold">á‹œáŒáŠá‰µ</label>
                    <input type="text" id="nationality" required class="w-full p-2 border rounded">
                </div>
                <div><label class="required font-semibold">áˆµáˆáŠ­ á‰áŒ¥áˆ­</label>
                    <input type="tel" id="guestPhone" required class="w-full p-2 border rounded">
                </div>
                <div><label class="required font-semibold">á‹¨áŒˆá‰£á‰ á‰µ á‰€áŠ•</label>
                    <input type="date" id="checkIn" required class="w-full p-2 border rounded">
                </div>
                <div><label class="required font-semibold">á‹¨á‰†á‹­á‰³ á‰€áŠ“á‰µ</label>
                    <input type="number" id="stayDays" min="1" required oninput="calc()" class="w-full p-2 border rounded">
                </div>
                <div><label class="required font-semibold">á‹¨áŠ áŠ•á‹µ á‰€áŠ• áˆ‚áˆ³á‰¥</label>
                    <input type="number" id="dailyRate" required oninput="calc()" class="w-full p-2 border rounded">
                </div>
                <div><label class="required font-semibold">á‹¨á‰°áŠ¨áˆáˆˆ á‰¥áˆ­</label>
                    <input type="number" id="paidAmount" required oninput="calc()" class="w-full p-2 border rounded">
                </div>

                <div class="md:col-span-2 bg-blue-50 p-3 rounded-lg flex justify-between items-center font-bold border border-blue-100">
                    <span class="text-blue-900">áŒ á‰…áˆ‹áˆ‹á¡ <span id="totalText">0</span> á‰¥áˆ­</span>
                    <span class="text-red-600">á‰€áˆªá¡ <span id="balanceText">0</span> á‰¥áˆ­</span>
                </div>

                <div><label class="text-xs font-semibold text-gray-600">áˆ˜á‰³á‹ˆá‰‚á‹« (áŠá‰µ)</label><input type="file" class="w-full text-xs"></div>
                <div><label class="text-xs font-semibold text-gray-600">áˆ˜á‰³á‹ˆá‰‚á‹« (áŒ€áˆ­á‰£)</label><input type="file" class="w-full text-xs"></div>

                <button type="submit" id="submitBtn" class="md:col-span-2 bg-blue-800 text-white py-3 rounded-lg font-bold hover:bg-blue-900 transition shadow-lg mt-2">
                    áˆ˜áˆ¨áŒƒ áˆ˜á‹áŒá‰¥ (Register)
                </button>
            </form>
        </div>
    </div>

    <script>
        const TELEGRAM_BOT_TOKEN = '8423372388:AAGlp0vl_Q2c9tgVw2vFQmgUyDicsksZ6qk';
        const TELEGRAM_CHAT_ID = '5541031736';

        const rooms = [101, 102, 103, 201, 202, 203, 301, 302, 303, 401, 402, 403, 501];
        let status = JSON.parse(localStorage.getItem('churchill_data')) || {};

        function render() {
            const grid = document.getElementById('roomGrid');
            grid.innerHTML = '';
            rooms.forEach(num => {
                const div = document.createElement('div');
                div.className = `room-card p-3 rounded shadow-sm font-bold ${status[num] ? 'occupied' : 'available'}`;
                div.innerHTML = `<div>${num}</div><div class="text-[10px]">${status[num] ? 'á‰°á‹­á‹Ÿáˆ' : 'áŠáƒ'}</div>`;
                div.onclick = () => { 
                    document.getElementById('roomNum').value = num;
                    if(status[num] && confirm("á‹­áˆ… áŠ­ááˆ á‰°á‹­á‹Ÿáˆá¤ áŠáƒ áˆ›á‹µáˆ¨áŒ á‹­áˆáˆáŒ‹áˆ‰?")) {
                        delete status[num];
                        localStorage.setItem('churchill_data', JSON.stringify(status));
                        render();
                    }
                };
                grid.appendChild(div);
            });
        }

        function calc() {
            const t = (document.getElementById('stayDays').value || 0) * (document.getElementById('dailyRate').value || 0);
            document.getElementById('totalText').innerText = t;
            document.getElementById('balanceText').innerText = t - (document.getElementById('paidAmount').value || 0);
        }

        document.getElementById('bookingForm').onsubmit = async (e) => {
            e.preventDefault();
            const btn = document.getElementById('submitBtn');
            const num = document.getElementById('roomNum').value;
            if(!num) return alert("áŠ¥á‰£áŠ­á‹ áˆ˜áŒ€áˆ˜áˆªá‹« áŠ­ááˆ á‹­áˆáˆ¨áŒ¡!");

            btn.disabled = true;
            btn.innerText = "á‰ áˆ˜áˆ‹áŠ­ áˆ‹á‹­...";

            const msg = `
ğŸ¨ *CHURCHILL GUEST HOUSE*
â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ğŸ  *áŠ­ááˆ á‰áŒ¥áˆ­:* ${num}
ğŸ‘¤ *áŠ¥áŠ•áŒá‹³:* ${document.getElementById('guestName').value}
ğŸŒ *á‹œáŒáŠá‰µ:* ${document.getElementById('nationality').value}
ğŸ“ *áˆµáˆáŠ­:* ${document.getElementById('guestPhone').value}
ğŸ“… *á‰€áŠ•:* ${document.getElementById('checkIn').value} (${document.getElementById('stayDays').value} á‰€áŠ•)
ğŸ’° *áŒ á‰…áˆ‹áˆ‹:* ${document.getElementById('totalText').innerText} á‰¥áˆ­
ğŸ’µ *á‹¨á‰°áŠ¨áˆáˆˆ:* ${document.getElementById('paidAmount').value} á‰¥áˆ­
âš ï¸ *á‰€áˆª:* ${document.getElementById('balanceText').innerText} á‰¥áˆ­
ğŸ‘¤ *áˆ˜á‹áŒ‹á‰¢:* ${document.getElementById('receptionName').value}
â”â”â”â”â”â”â”â”â”â”â”â”â”â”`;

            try {
                await fetch(`https://api.telegram.org/bot${TELEGRAM_BOT_TOKEN}/sendMessage`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ chat_id: TELEGRAM_CHAT_ID, text: msg, parse_mode: 'Markdown' })
                });
                status[num] = true;
                localStorage.setItem('churchill_data', JSON.stringify(status));
                alert("âœ… áˆ˜áˆ¨áŒƒá‹ á‰ á‰°áˆ³áŠ« áˆáŠ”á‰³ á‰°áˆ˜á‹áŒá‰§áˆ!");
                render();
                e.target.reset();
            } catch (err) { alert("áŠ¢áŠ•á‰°áˆ­áŠ”á‰µ á‹¨áˆˆáˆ á‹ˆá‹­áˆ á‰½áŒáˆ­ á‰°áˆáŒ¥áˆ¯áˆ!"); }
            finally { btn.disabled = false; btn.innerText = "áˆ˜áˆ¨áŒƒ áˆ˜á‹áŒá‰¥ (Register)"; }
        };
        render();
    </script>
</body>
</html>
